CREATE CONSTRAINT n10s_unique_uri FOR (r:Resource)
REQUIRE r.uri IS UNIQUE;
CALL n10s.graphconfig.init();
CALL n10s.onto.import.fetch("http://purl.obolibrary.org/obo/go.owl","RDF/XML");
[Class2 rdfs:subClassOf Class1]

// find all GO terms that overlap with current SR terms:
CALL {MATCH (n:PHYS)
WITH COLLECT(REPLACE(n.id, ":", "_")) AS terms
return terms}
WITH terms
MATCH (m:n4sch__Class)
WHERE m.n4sch__name in terms
return m

// Use list of overlapping nodes to merge nodes:
CALL {MATCH (n:PHYS)
return n, COLLECT(REPLACE(n.id, ":", "_")) AS terms}
WITH n, terms
MATCH (m:n4sch__Class)
WHERE m.n4sch__name in terms
CALL apoc.refactor.mergeNodes([n, m],
     {properties:"combine", mergeRels:true})
Yield node
return node

// assign GO terms as physiology.
MATCH (n:n4sch__Class)
SET n:PHYS
RETURN count(n)

// remove RDF class label
CALL db.labels()
YIELD label WHERE label <> "PHYS"
WITH collect(label) AS labels
MATCH (p:n4sch__Class)
WITH collect(p) AS class, labels
CALL apoc.create.removeLabels(class, labels)
YIELD node
RETURN node, labels(node) AS labels;

// reuse RDF id and label 
CALL db.labels()
YIELD label WHERE label <> "PHYS"
WITH collect(label) AS labels
MATCH (p:n4sch__Class)
WITH collect(p) AS class, labels
CALL apoc.create.removeLabels(class, labels)
YIELD node
RETURN node, labels(node) AS labels;

// Remove RDF properties
MATCH (n:PHYS)
SET n.id = n.n4sch__name, n.preflabel = n.n4sch__label
REMOVE n.n4sch__name, n.n4sch__label
return n
SET n.id = n.n4sch__name, n.preflabel = n.n4sch__label
REMOVE n.n4sch__name, n.n4sch__label
return n
